---
layout: post
title: ジレンマとVPSによるサーバ構築とフロントエンド
categories: サーバ Mastodon Twitter 1次創作 心持ち
---

創作仲間を見て感じるのだけど、自分はどーも自分の作品を宣伝するのが苦手らしい。  
自分１人の創作を中心にやっていた時期は全然そんなこともないのじゃないかと思っていたものの、集団創作をやっていると自分だけが作品を宣伝する頻度が極端に低い。  
自分自身、宣伝や広告の類が非常に苦手で、他のメンバーが頻繁に作品を宣伝しているため、バランスを取ろうとして宣伝を控えているという説を考えていた。  
でも、他にも理由があるんじゃなかろうか。  
そんな発想が浮かんできてしまいました。

ボクはおそらく、自分が書く物を面白いと思い込む深層心理より、面白くないと考える深層心理のほうが強く影響していて、面白いと感じない作品を宣伝したところで読んでもらうことに対して引け目を感じるため自分の作品の宣伝に抵抗があるようです。 

ただ困ったことに「じゃあ自分の作品が(実際はどうかに関わらず)面白い」と思い込めばいいかと聞かれると、それもまた懸念がある。  
なぜかというと、自分の作る物に対して肯定的な評価を強めると、そこに甘えが発生して物作りにおける成長が止まってしまうため。  
……創作者としてのボクは、このジレンマとまだまだ向き合っていかなきゃいけないのだ。  
最近、そんなことを考えています。

## なんて、辛気臭い話はさておき。

諸事情あり、VPSのレンタルとドメインの取得を行いました。  
ボク自身はこれまでサーバ構築なんて今までやったこともなく、強いて言えばデスクトップPCに増設した内蔵SSDでAntergosをぶん回して喜んでいるような人間です。  
これ、分かる人が見れば「何だお前その程度かよ」と嘲笑される程度のスキルですし、事実Web周りの知識はかなり乏しいです。  
ですが、(仮想か物理かは問わず)自分専用のサーバで遊びたいなーとは以前から考えていました。  
Webサイトを立ち上げるサービスなんてのはこのご時世そこら中に転がっているものですが、ボク自身はそんなものを使わず1からサーバを構築した上で、自由にcronを使ってスケジュールに沿ったスクリプト実行を行うこともできる環境が欲しかったのでした。  
また、最近話題のmastodonなんてのもあります。  
本職上この手のサービスには目を光らせないといけない[^1]ですが、オープンソースかつ分散型でポストTwitterとも言われたりするSNSとなれば、それはもちろん触れてみたくなるもの。  
そして、ボクの参加しているアルモニアプロジェクト(Twitterアカウントは[こちら](https://twitter.com/armn_p))にもWebサイトがあるといいな、という言葉がメンバー内[^2]から出ていたのもあり。  
こんな感じで様々な理由が積み重なり、ついにサーバ構築に手を出してみることにしました。  

で、実際どうかというと。

### 正直非常に手間がかかった。

分からないことや詰まったことがあったら逐一某G先生の検索に頼るばかり。  
自分の今までの知識、あまり役に立たずヘコみました。  
GWということで時間はたっぷりあったので、セットアップがある程度長引く覚悟は持てていたものの、丸１日かけて静的ページを表示させるのがやっとという体たらく。  
……言い訳をすると、ボクは実践で知識を定着させていくタイプなので、とてもいい経験ではあるのですが。  
なかなかに根気を要する作業ではありました。  
その中で閲覧したドキュメントもまた比較的多く、正直これをまた後で探して回るのは負担でしかない。  
そういうワケで、このエントリは以降しばらく備忘録となります。  
何をやっているか分かる方も分からない方も、興味があればどうぞ。  

VPSは
\\[
\begin{array}{|r|r|}
  \hline
  VPS & さくらVPS \\\
  \hline
  ドメイン & スタードメインで取得 \\\
  \hline
  OS & Ubuntu\\ 16.04\\ 64bit \\\
  \hline
  メモリ & 1GB \\\
  \hline
  ストレージ & 100GB \\\
  \hline
\end{array}
\\\]

まず、[ここ](https://mlny.info/2016/04/ubuntu-xenial-on-sakura-vps/)を参考にしてUbuntuをインストール。  
OSの選択理由は、Debianの派生OSをこれまで最もよく使ってきていて、aptなどに比較的馴染があったため。  
次にnginxをインストールした上で、取得済みのドメインをVPSへ設定。  
ここがもう、尋常ならざるほどストレスフル。  
主に参考になったのは[こちら](http://tryerror.net/tryerror/wordpress/さくらｖｐｓに独自ドメインを割り当てる)と[こちら](http://wada811.blogspot.com/2014/11/sakura-vps-domain-settings.html)でしたが、数年前の記事ということもありコントロールパネルのUIが全く違う。  
おかげで、設定がしづらいったらありゃしない。  
これと前後してSSH接続も試みていたのですが、コマンド履歴に生のIPアドレスやポート番号を残したくなかったため早く終わらせたいという焦りが逆効果化。  
そして、前段階で`ufw default deny`で全ポートを閉鎖してから諸々の設定を始めたのも重なり、しばらくnginxのデフォルトページすら見ることができなかったというオマケつき[^3]。  
早すぎる第一関門でした。

その後、nginxの初期設定。  
参考にしたのは[ここ](http://shadowkrr.hateblo.jp/entry/2016/01/27/ubuntu%25e3%2581%25abnginx%25e3%2582%2592%25e3%2582%25a4%25e3%2583%25b3%25e3%2582%25b9%25e3%2583%2588%25e3%2583%25bc%25e3%2583%25ab%25e3%2581%2599%25e3%2582%258b/)、[ここ](http://qiita.com/kidach1/items/985efebba639713c562e)、[ここ](http://qiita.com/syou007/items/3e2d410bbe65a364b603)。
実際に自分の書いた通りのページが表示されるとやっぱり嬉しいもので、ボクはここでちょっとガッツポーズしたりしました。  
やっぱり一番可視化されやすい部分が一番モチベーションが高いんだよね。  
要するに「フロントエンド>サーバサイド>インフラ」。  
それでいて一喜一憂が纏めて土壺にハマるのはインフラ側だから始末に終えない。

そんなこんなで、最低限の設定を終えました。  
ここで思うワケです。  
サブドメインを取得して、そこでmastodonインスタンスを作りたいなと。  
他にも今使っているブログにサブドメインを設定して、自分の管理下にあることをより強くアピールしたいなと。  
考えてみれば、ここが更なる悲劇の始まりだった……

DNS側のサブドメイン設定は、[正直大した負担ではありません](http://www.star-domain.jp/man/domain_sub_add.php)。  
問題は[サブドメインを](http://mikamisan.hatenablog.com/entry/2016/07/10/113655)[VPSに設定](http://mekori.hatenablog.com/entry/2013/04/20/231157)する段階。  
~~正直不便すぎてさくらのVPSのコンパネを使いたくないですが~~我慢してやってみる。  
しかし、加えて設定ファイルの書き換えが`nginx restart`では反映されない[^4]。  
最後にブログへのサブドメイン設定をしようとしたらDNS側でcname(？)の設定ができず、nginxで[リバースプロキシ](https://blog.yuyat.jp/post/serving-github-pages-through-reverse-proxy/)を行うことになったものの、ここではSSH部分の設定が上手くいかずにこのブログのホスト名で現状暗号化処理が行われないというお粗末(なのかも分からないのでむしろ杜撰と言うべきかもしれない)仕様というオチ。  

そんなこんなありまして、非常に疲れたのでした[^5]。  

## それと、この先どうしようか

ひとまずアルモニアプロジェクトの公式ページを作りたい。  
あと、今後数日でmastodonインスタンスを立てたい。

＜追記＞  
ブログの暗号化処理を達成。    
個人用mstdnインスタンスも立てました。  

[^1]: 言うほど光らせてない
[^2]: 主に原案
[^3]: `ufw allow "ポート番号"` でhttp用のポートを解放
[^4]: `nginx -s reload`で設定ファイルを再読み込み ([参照](http://abyssluke.hatenablog.com/entry/2015/12/11/203707))
[^5]: この記事を書いただけ更に疲労が加算
